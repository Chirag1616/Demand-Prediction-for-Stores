import yaml
from train import train_and_log

# Load YAML config
with open("experiments.yaml", "r") as f:
    config = yaml.safe_load(f)

data_path = config["data_path"]
output_dir = config.get("output_dir", "outputs")
experiment_name = config.get("experiment_name", "default-experiment")

for model_cfg in config["models"]:
    model_name = model_cfg["name"]
    model_params = model_cfg.get("params", {})
    run_name = f"{model_name}_" + "_".join(f"{k}{v}" for k,v in model_params.items())
    print(f"Running experiment: {run_name}")
    
    train_and_log(
        data_path=data_path,
        output_dir=output_dir,
        experiment_name=experiment_name,
        run_name=run_name,
        model_name=model_name,
        model_params=model_params
    )
